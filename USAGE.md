# Lens Service Widget 使用指南

這份文檔將指導您如何使用 Lens Service Widget 的各項功能。

## 📖 目錄

1. [客服 Widget 功能](#客服-widget-功能)
2. [管理後台功能](#管理後台功能)
3. [系統設定](#系統設定)
4. [手動索引管理](#手動索引管理)
5. [客服對話管理](#客服對話管理)
6. [最佳實踐](#最佳實踐)

## 🎯 客服 Widget 功能

### 開啟客服面板

Widget 會在頁面右下角顯示一個客服按鈕。用戶點擊按鈕即可開啟客服面板。

### 發送訊息

1. 在輸入框中輸入問題
2. 點擊發送按鈕或按 Enter 鍵
3. AI 客服會自動回覆

### 查看歷史記錄

1. 點擊客服面板右上角的歷史記錄圖標
2. 查看所有歷史對話
3. 點擊任一對話可以重新載入該對話

### AI 回覆流程

1. **搜索手動索引**：系統會先搜索管理員建立的手動索引
2. **搜索 LLMs.txt**：如果設定了 llms.txt URL，系統會搜索網站文檔
3. **LLM 判斷**：使用 Azure OpenAI 判斷是否能回答
4. **回覆或通知**：
   - 如果能回答：返回 AI 生成的回覆
   - 如果不能回答：返回預設回覆並發送 Telegram 通知給客服團隊

## 🛠️ 管理後台功能

訪問管理後台：`http://localhost:3000/lens-service`

### 登入

使用預設帳號登入：
- **用戶名**：lens
- **密碼**：1234

或

- **用戶名**：admin
- **密碼**：admin123

## ⚙️ 系統設定

### 修改預設回覆

1. 進入管理後台
2. 點擊左側導航欄的「系統設定」
3. 找到「無法回答時的固定回覆」
4. 點擊「編輯」按鈕
5. 輸入新的回覆內容
6. 點擊「儲存」

**範例**：
```
此問題我們會在 3 小時內給予回覆，請稍候。
```

### 修改 LLM 系統提示詞

1. 在系統設定頁面找到「LLM系統提示詞」
2. 點擊「編輯」按鈕
3. 輸入新的提示詞
4. 點擊「儲存」

**範例**：
```
你是一個專業的客服助理，請根據提供的資料回答用戶問題。
如果沒有相關資料，請告知用戶會轉交給人工客服處理。
```

### 設定 LLMs.txt 網址

1. 在系統設定頁面找到「LLMs.txt 網址」
2. 點擊「編輯」按鈕
3. 輸入您的 llms.txt 網址
4. 點擊「儲存」

**範例**：
```
https://www.ask-lens.ai/llms.txt
```

**什麼是 LLMs.txt？**

LLMs.txt 是一個專為 AI 代理設計的網站文檔格式。系統會自動：
- 抓取該網址的內容
- 將內容切分成 chunks（500 字符，100 字符重疊）
- 搜索相關的 chunks 並包含前後文
- 提供給 LLM 作為回答的參考資料

### 管理管理員帳號

#### 新增管理員

1. 在系統設定頁面找到「管理員帳號」區塊
2. 點擊「+ 新增管理員」按鈕
3. 輸入用戶名、密碼和 Email
4. 點擊「儲存」

#### 刪除管理員

1. 找到要刪除的管理員
2. 點擊「刪除」按鈕
3. 確認刪除

## 📝 手動索引管理

手動索引是 AI 客服的知識庫，用於回答常見問題。

### 新增索引

1. 點擊左側導航欄的「手動索引」
2. 點擊「+ 新增索引」按鈕
3. 填寫以下資訊：
   - **標題**：索引的名稱（例如：產品價格資訊）
   - **描述**：簡短描述（用於搜索匹配）
   - **內容**：詳細的回答內容
   - **網址**：相關網址（選填）
4. 點擊「儲存」

**範例**：

```
標題：產品價格資訊
描述：產品定價方案說明
內容：我們的產品提供三種方案：
- 基礎版每月 $99
- 專業版每月 $299
- 企業版每月 $999
所有方案都包含 7 天免費試用。
網址：https://example.com/pricing
```

### 編輯索引

1. 在手動索引列表中找到要編輯的索引
2. 點擊「編輯」按鈕
3. 修改內容
4. 點擊「儲存」

### 刪除索引

1. 找到要刪除的索引
2. 點擊「刪除」按鈕
3. 在確認對話框中點擊「確定」

### 索引搜索原理

系統使用以下方式搜索索引：
1. **文字匹配**：搜索標題、描述和內容中的關鍵字
2. **向量搜索**：使用標題和描述進行語義搜索
3. **結果合併**：將匹配的索引提供給 LLM 作為上下文

## 💬 客服對話管理

### 查看對話列表

1. 點擊左側導航欄的「客服對話」
2. 查看所有對話記錄
3. 每個對話顯示：
   - 對話 ID
   - 訊息數量
   - 創建時間

### 查看對話詳情

1. 在對話列表中點擊任一對話
2. 查看完整的對話記錄
3. 包含用戶訊息和 AI 回覆

### 回覆客戶

1. 在對話詳情中找到「客服回覆」區塊
2. 在文字框中輸入回覆內容
3. 點擊「發送回覆」按鈕
4. 回覆會立即添加到對話中

**用戶端查看回覆**：
1. 用戶打開客服面板
2. 點擊歷史記錄圖標
3. 選擇該對話
4. 即可看到客服的回覆

### 刪除對話

1. 在對話詳情中點擊「刪除」按鈕
2. 在確認對話框中點擊「確定」
3. 對話將被永久刪除

## 🎯 最佳實踐

### 建立完整的知識庫

1. **常見問題**：為所有常見問題建立索引
2. **產品資訊**：包含產品功能、價格、規格等
3. **聯絡方式**：客服電話、Email、營業時間等
4. **政策說明**：退換貨政策、隱私政策等

### 優化索引內容

1. **清晰的標題**：使用描述性的標題
2. **詳細的描述**：幫助系統更好地匹配用戶問題
3. **完整的內容**：提供足夠的資訊讓 AI 能夠回答
4. **定期更新**：保持資訊的準確性和時效性

### 設定合適的預設回覆

預設回覆應該：
1. 禮貌且專業
2. 告知用戶會有人工客服跟進
3. 提供預計回覆時間
4. 可選：提供其他聯絡方式

### 監控和改進

1. **定期查看對話**：了解用戶常問的問題
2. **分析無法回答的問題**：透過 Telegram 通知了解 AI 的限制
3. **補充索引**：為無法回答的問題建立新索引
4. **優化提示詞**：根據回答品質調整系統提示詞

### 使用 LLMs.txt

1. **建立專門頁面**：在您的網站建立 `/llms.txt` 頁面
2. **包含關鍵資訊**：產品介紹、功能說明、使用指南等
3. **結構化內容**：使用清晰的標題和段落
4. **定期更新**：保持內容的最新狀態

## 🔄 工作流程範例

### 典型的客服工作流程

1. **用戶提問**：用戶在客服面板輸入問題
2. **AI 自動回覆**：
   - 如果能回答：立即提供答案
   - 如果不能回答：返回預設回覆
3. **客服介入**：
   - 收到 Telegram 通知
   - 登入管理後台查看對話
   - 提供人工回覆
4. **用戶查看**：用戶在歷史記錄中看到客服回覆
5. **知識庫更新**：為新問題建立索引，避免下次再問

## 📊 效能優化

### 快取機制

- LLMs.txt 內容會快取 1 小時
- 減少重複抓取，提升回應速度

### 搜索優化

- 使用索引提升資料庫查詢效能
- 限制搜索結果數量（Top 5）

## 🆘 常見問題

### Q: AI 無法回答某些問題？

**A**: 請檢查：
1. 是否有相關的手動索引
2. LLMs.txt 是否包含相關資訊
3. 系統提示詞是否合適

### Q: 如何測試新的索引？

**A**: 
1. 在管理後台新增索引
2. 在客服面板輸入相關問題
3. 查看 AI 是否使用該索引回答

### Q: 如何更改預設回覆？

**A**: 在系統設定頁面編輯「無法回答時的固定回覆」

### Q: Telegram 通知沒有收到？

**A**: 請檢查：
1. Bot Token 和 Chat ID 是否正確
2. Bot 是否已加入群組
3. 查看瀏覽器控制台的錯誤訊息

## 📚 更多資源

- [安裝指南](./INSTALLATION.md)
- [API 文檔](./API.md)
- [故障排除](./TROUBLESHOOTING.md)

